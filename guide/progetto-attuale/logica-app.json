{
  "last_update": "2026-02-15T15:00:00Z",
  "task_completed": "FN-ActivityLog-Filter",
  "feature_logic": {
    "feature_name": "Activity Log - Filtro 'Miei Scontri'",
    "summary": "Miglioramento dell'Activity Log con un nuovo filtro 'Aste Partecipate' che mostra solo gli eventi relativi ai giocatori su cui l'utente ha fatto offerte.",
    "architectural_pattern": "Filtro server-side basato su subquery SQL. Il client invia un flag `myBiddedPlayers=true` e l'API filtra i risultati (Bids, Auctions, Budget) incrociando con gli ID dei giocatori presenti nello storico offerte dell'utente.",
    "user_flow": [
      "1. L'utente apre il pannello filtri nell'Activity Log.",
      "2. Attiva il toggle 'Solo Aste Partecipate'.",
      "3. La lista si aggiorna mostrando solo le aste (e relative offerte/transazioni) in cui l'utente Ã¨ stato attivo.",
      "4. Eventi globali non pertinenti (es. login/logout) vengono nascosti per ridurre il rumore."
    ],
    "core_components_interaction": {
      "src/app/api/leagues/[id]/activity-log/route.ts": "Gestisce il parametro `myBiddedPlayers` e inietta la clausola `WHERE player_id IN (...)`.",
      "src/components/activity-log/ActivityLogClient.tsx": "Gestisce lo stato del toggle e aggiorna la query string della richiesta fetch."
    },
    "database_interactions": [
      {
        "table": "bids, auctions",
        "operation": "SELECT (Subquery)",
        "description": "Recupera ID giocatori con offerte dell'utente."
      },
      {
        "table": "bids, auctions, budget_transactions, user_auction_response_timers",
        "operation": "SELECT",
        "description": "Filtra i record principali usando la lista di ID giocatori recuperata."
      }
    ]
  }
}
